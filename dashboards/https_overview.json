{
    "title": "HTTPS Request Dashboard",
    "description": "",
    "inputs": {
        "input_global_trp": {
            "options": {
                "defaultValue": "-24h@h,now",
                "token": "global_time"
            },
            "title": "Global Time Range",
            "type": "input.timerange"
        }
    },
    "defaults": {
        "dataSources": {
            "ds.search": {
                "options": {
                    "queryParameters": {
                        "earliest": "$global_time.earliest$",
                        "latest": "$global_time.latest$"
                    }
                }
            }
        },
        "visualizations": {
            "global": {
                "showProgressBar": true
            }
        }
    },
    "visualizations": {
        "viz_Nk7dOqO3": {
            "containerOptions": {
                "description": {
                    "color": "#ffffff"
                },
                "title": {
                    "color": "#ffffff"
                }
            },
            "dataSources": {
                "primary": "ds_Sd5W9tV3"
            },
            "description": "Monitor IP addresses accessing important endpoints",
            "options": {
                "backgroundColor": "#708794",
                "tableFormat": {
                    "headerBackgroundColor": "> backgroundColor | setColorChannel(tableHeaderBackgroundColorConfig)",
                    "headerColor": "> headerBackgroundColor | maxContrast(tableRowColorMaxContrast)",
                    "rowBackgroundColors": "> table | seriesByIndex(0) | pick(tableAltRowBackgroundColorsByBackgroundColor)",
                    "rowColors": "> rowBackgroundColors | maxContrast(tableRowColorMaxContrast)"
                }
            },
            "title": "Suspicious Endpoints",
            "type": "splunk.table"
        },
        "viz_P1wNL61X": {
            "options": {
                "customFontSize": 50,
                "fontColor": "#ffffff",
                "fontSize": "custom",
                "markdown": "HTTPS Monitor Dashboard"
            },
            "type": "splunk.markdown"
        },
        "viz_annNiCWJ": {
            "containerOptions": {
                "description": {
                    "color": "#ffffff"
                },
                "title": {
                    "color": "#ffffff"
                }
            },
            "dataSources": {
                "primary": "ds_aYisq8iE"
            },
            "description": "Shows popular activity on the website",
            "options": {
                "backgroundColor": "#708794",
                "tableFormat": {
                    "headerBackgroundColor": "> backgroundColor | setColorChannel(tableHeaderBackgroundColorConfig)",
                    "headerColor": "> headerBackgroundColor | maxContrast(tableRowColorMaxContrast)",
                    "rowBackgroundColors": "> table | seriesByIndex(0) | pick(tableAltRowBackgroundColorsByBackgroundColor)",
                    "rowColors": "> rowBackgroundColors | maxContrast(tableRowColorMaxContrast)"
                }
            },
            "showLastUpdated": false,
            "showProgressBar": true,
            "title": "Most Common URL Paths",
            "type": "splunk.table"
        },
        "viz_rKOtPVdS": {
            "containerOptions": {
                "description": {
                    "color": "#ffffff"
                },
                "title": {
                    "color": "#ffffff"
                },
                "visibility": {}
            },
            "dataSources": {
                "primary": "ds_btuHyC3h"
            },
            "description": "Displays top 10 IPs visiting the website",
            "options": {
                "backgroundColor": "#708794",
                "lineWidth": 3.5,
                "showLineSmoothing": true,
                "xAxisLabelVisibility": "show"
            },
            "showLastUpdated": false,
            "showProgressBar": true,
            "title": "Most frequent IP Addresses",
            "type": "splunk.line"
        },
        "viz_ySII1bIF": {
            "containerOptions": {
                "description": {
                    "color": "#ffffff"
                },
                "title": {
                    "color": "#ffffff"
                }
            },
            "dataSources": {
                "primary": "ds_LDr9ibmt"
            },
            "description": "Scale for humans and bots on website",
            "options": {
                "backgroundColor": "#708794"
            },
            "showLastUpdated": false,
            "showProgressBar": true,
            "title": "Human VS Bot",
            "type": "splunk.pie"
        }
    },
    "dataSources": {
        "ds_JMesMRBF": {
            "name": "Search_1",
            "options": {
                "query": "source=\"httpsLogs.log\" index=\"main\" sourcetype=\"access_combined\"| stats count BY clientip\r\n| sort - count\r\n| head 10"
            },
            "type": "ds.search"
        },
        "ds_KEAEMQzb": {
            "name": "Table search",
            "options": {
                "query": "source=\"httpsLogs.log\" index=\"main\" sourcetype=\"access_combined\" | iplocation clientip\r\n| geostats count BY Country",
                "queryParameters": {
                    "earliest": "0",
                    "sampleRatio": 1
                }
            },
            "type": "ds.search"
        },
        "ds_LDr9ibmt": {
            "name": "Table search",
            "options": {
                "query": "source=\"httpsLogs.log\" index=\"main\" sourcetype=\"access_combined\" | eval client_type=if(match(useragent,\"(?i)bot|spider|crawl|curl|wget\"),\"Bot\",\"Human\")\r\n| stats count BY client_type",
                "queryParameters": {
                    "earliest": "0",
                    "sampleRatio": 1
                }
            },
            "type": "ds.search"
        },
        "ds_Sd5W9tV3": {
            "name": "Table search",
            "options": {
                "query": "source=\"httpsLogs.log\" index=\"main\" sourcetype=\"access_combined\" | where uri_path LIKE \"/admin%\" OR uri_path LIKE \"%.env%\" OR uri_path LIKE \"%passwd%\"\r\n| stats count BY clientip, uri_path",
                "queryParameters": {
                    "earliest": "0",
                    "sampleRatio": 1
                }
            },
            "type": "ds.search"
        },
        "ds_aYisq8iE": {
            "name": "Table search",
            "options": {
                "query": "source=\"httpsLogs.log\" index=\"main\" sourcetype=\"access_combined\" | stats count BY uri_path\r\n| sort - count\r\n| head 10",
                "queryParameters": {
                    "earliest": "0",
                    "sampleRatio": 1
                }
            },
            "type": "ds.search"
        },
        "ds_btuHyC3h": {
            "name": "Table search",
            "options": {
                "query": "source=\"httpsLogs.log\" index=\"main\" sourcetype=\"access_combined\" | stats count BY clientip\r\n| sort - count\r\n| head 10",
                "queryParameters": {
                    "earliest": "0",
                    "sampleRatio": 1
                }
            },
            "type": "ds.search"
        },
        "ds_pUOLJiDf": {
            "name": "Table search",
            "options": {
                "query": "source=\"httpsLogs.log\" index=\"main\" sourcetype=\"access_combined\" | stats count BY clientip\r\n| sort - count\r\n| head 10",
                "queryParameters": {
                    "earliest": "0",
                    "sampleRatio": 1
                }
            },
            "type": "ds.search"
        },
        "ds_pcmOdVgC": {
            "name": "Table search",
            "options": {
                "query": "source=\"httpsLogs.log\" index=\"main\" sourcetype=\"access_combined\" | search NOT method=GET NOT method=POST\r\n| stats count BY method, uri_path, clientip",
                "queryParameters": {
                    "earliest": "0",
                    "sampleRatio": 1
                }
            },
            "type": "ds.search"
        },
        "ds_qtRWwLBF": {
            "name": "Errors in the last 24 hours",
            "options": {
                "app": "search",
                "ref": "Errors in the last 24 hours"
            },
            "type": "ds.savedSearch"
        },
        "ds_rl2c9vqA": {
            "name": "Table search",
            "options": {
                "query": "source=\"httpsLogs.log\" index=\"main\" sourcetype=\"access_combined\" status>=500\r\n| bin _time span=15m\r\n| stats count AS count BY _time status",
                "queryParameters": {
                    "earliest": "0",
                    "sampleRatio": 1
                }
            },
            "type": "ds.search"
        },
        "ds_tYXYllkW": {
            "name": "Table search",
            "options": {
                "query": "source=\"httpsLogs.log\" index=\"main\" sourcetype=\"access_combined\" status>=400\r\n| stats count BY status, uri_path\r\n| sort - count",
                "queryParameters": {
                    "earliest": "0",
                    "sampleRatio": 1
                }
            },
            "type": "ds.search"
        }
    },
    "layout": {
        "globalInputs": [
            "input_global_trp"
        ],
        "layoutDefinitions": {
            "layout_1": {
                "options": {
                    "backgroundColor": "#708794",
                    "display": "fit-to-width",
                    "height": 800,
                    "width": 1440
                },
                "structure": [
                    {
                        "item": "viz_rKOtPVdS",
                        "position": {
                            "h": 320,
                            "w": 1050,
                            "x": 0,
                            "y": 100
                        },
                        "type": "block"
                    },
                    {
                        "item": "viz_annNiCWJ",
                        "position": {
                            "h": 380,
                            "w": 740,
                            "x": 0,
                            "y": 420
                        },
                        "type": "block"
                    },
                    {
                        "item": "viz_ySII1bIF",
                        "position": {
                            "h": 320,
                            "w": 400,
                            "x": 1040,
                            "y": 100
                        },
                        "type": "block"
                    },
                    {
                        "item": "viz_P1wNL61X",
                        "position": {
                            "h": 70,
                            "w": 640,
                            "x": 430,
                            "y": 20
                        },
                        "type": "block"
                    },
                    {
                        "item": "viz_Nk7dOqO3",
                        "position": {
                            "h": 380,
                            "w": 700,
                            "x": 740,
                            "y": 420
                        },
                        "type": "block"
                    }
                ],
                "type": "absolute"
            }
        },
        "options": {},
        "tabs": {
            "items": [
                {
                    "label": "New tab",
                    "layoutId": "layout_1"
                }
            ]
        }
    },
    "applicationProperties": {}
}
